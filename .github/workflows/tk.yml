name: txt转excel工具  
  
on:  
  workflow_dispatch:  
  
permissions:  
  contents: read  
  
jobs:  
  pyinstaller-build:  
    runs-on: windows-latest  
    steps:  
      - name: Checkout Repository  
        uses: actions/checkout@v4  
  
      - name: Set up Python  
        uses: actions/setup-python@v5  
        with:  
          python-version: '3.12'  
  
      - name: Install Dependencies  
        run: |  
          python -m pip install --upgrade pip  
          pip install xlwt  # 安装xlwt模块  
          pip install pyinstaller  # 确保pyinstaller已安装  
  
      - name: Create Executable  
        uses: sayyid5416/pyinstaller@v1  
        with:  
          python_ver: '3.12'  
          spec: 'tk.py'  # 假设您的主脚本是tk.py  
          upload_exe_with_name: 'tk'  
          options: --onefile --name "txt_to_excel" --windowed  # 注意：选项之间用空格分隔，不要使用逗号  
  
      # 如果您希望将生成的exe文件作为工件上传，可以添加以下步骤  
      - name: Upload Executable as Artifact  
        uses: actions/upload-artifact@v4  
        with:  
          name: txt_to_excel_executable  
          path: dist/txt_to_excel.exe  # 假设exe文件生成在dist目录下，且文件名为txt_to_excel.exe
